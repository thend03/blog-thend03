<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ubuntu22.04安装wordpress | Fayy&amp;Fc's Blog</title>
<meta name=keywords content="wordpress"><meta name=description content="如何在ubuntu22.04上安装wordpress"><meta name=author content="since"><link rel=canonical href=https://blog.thend03.com/posts/install-wordpress-on-ubuntu22.04/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://blog.thend03.com/img/logo.jpg><link rel=icon type=image/png sizes=16x16 href=https://blog.thend03.com/img/logo.jpg><link rel=icon type=image/png sizes=32x32 href=https://blog.thend03.com/img/logo.jpg><link rel=apple-touch-icon href=https://blog.thend03.com/img/logo.jpg><link rel=mask-icon href=https://blog.thend03.com/img/logo.jpg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://blog.thend03.com/posts/install-wordpress-on-ubuntu22.04/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta property="og:title" content="Ubuntu22.04安装wordpress"><meta property="og:description" content="如何在ubuntu22.04上安装wordpress"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.thend03.com/posts/install-wordpress-on-ubuntu22.04/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-12T08:43:49+08:00"><meta property="article:modified_time" content="2023-12-12T08:43:49+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ubuntu22.04安装wordpress"><meta name=twitter:description content="如何在ubuntu22.04上安装wordpress"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"📚文章","item":"https://blog.thend03.com/posts/"},{"@type":"ListItem","position":2,"name":"Ubuntu22.04安装wordpress","item":"https://blog.thend03.com/posts/install-wordpress-on-ubuntu22.04/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Ubuntu22.04安装wordpress","name":"Ubuntu22.04安装wordpress","description":"如何在ubuntu22.04上安装wordpress","keywords":["wordpress"],"articleBody":"前言 最近在研究建站的事情，wordpress不论从保有量还是生态丰富的层面，并且作为一个老牌的开源系统，解决方案非常丰富，所以我打\n算使用wordpress作为建站工具，研究下如何使用wordpress建站。\n研究过程中踩了不少的坑，记录下，提供下简洁明了可用的安装过程。\n遇到的坑 php版本过高的问题 本来买的1c1g的小水管机器，为了节约机器，打算使用免费的数据库云服务。\n找到了2个产品，分别的plantscale和supabase，第一个是mysql的云服务，但是要绑信用卡，就放弃了。第二个是postgressql,免费的服务，不需要绑定信用卡，所以就注册了一个pg库。\n我在冲浪的时候看到别人也推荐pg，占用资源少，性能更好，所以我也倾向于使用\n然后磨人的就来了，由于wordpress原生只支持MySQL，想使用pg就得找个插件，这一步就掉坑里了，我冲浪的时候发现pg4wp这个插\n件最新版需要php8.1以上，然后安装这个插件之后各种连接超时，权限问题，我是真的被折磨的有点惨。\n通过Nginx访问wp-admin/install.php，报错connection timeout，各种搜索解决不了。后来灵机一动，把pg4wp插件挪走，php版本从\n8.2降到7.4就好了。。。。\n嘿，果然安装还是按照文档来，切忌一上来就想法比较多，使用其他最新的组件，比如pg。\n各种403，404，502，504，搜遍英文网站找不到结果，试了又试，错误依旧，绝望，我都有点怀疑自己了。\nwordpress6.4.2要求php7.4+，但是pg4wp要求php8.1+，虽然一般会版本向下兼容，但是不兼容的事还是被我遇到了,看pg4wp的\nreadme，在6.4.1上通过了兼容性测试，6.4.2就多了一个小版本，真的是。\n安装文档缺失关键步骤 wordpress有一个经典的五步安装法，但是缺少了一些关键的描述，比如如何访问install.php，文档介绍是使用web服务器，但具体怎么\n做没有详细介绍，导致我进去就掉坑里了。还有一些其他的细节没有补充。\n而且基本是英文文档，看下来略微有点吃力。\n这是wordpress开发者网站的安装步骤，我最需要的一步，如何在浏览器里访问install.php没写，让你用web浏览器去访问，用apache还\n是用nginx还是别的，一点都没写。\n英文文档看下来还是要点时间的。\n文件权限问题 由于是使用root用户登录的，所以我第一次安装目录是/root/wordpress，nginx访问报文件权限问题，挪到非root目录nginx访问就正常了。\n所以省事起见，wordpress不要放在root。\n另外wordpress目录的用户组和目录权限需要为www-data:www-data和755。其中www-data是php7.4-fpm进程的用户组。\n本篇文章力求把一些配置，关键步骤解释清楚，不踩无谓的坑。\n前置依赖 Wordpress是一个服务，需要我们部署服务之后去访问wordpress的页面，最少需要一台机器部署wordpress整套服务.\n如果需要使用域名访问的话，还需要买一个域名，解析到我们机器的ip上才行。\nwordpress自身需要如下的组件\n一台linux机器，我这次安装的机器版本是ubuntu222.04 wordpress安装包，在wordpress.org下载最新的安装包，最新版本是6.4.2 机器上安装了php，版本最好是7.4 一个可用的mysql服务，版本需要5.7或者8.0+或者对应版本的mariadb(和mysql同一个作者) 机器上安装Nginx，nginx版本为1.18.0+ 如果需要域名访问，则需要购买一个域名，购买域名之后解析到自己的linux机器上\n购买一个域名 将域名解析到linux机器所在ip 以下将基于如上的依赖条件，逐步进行安装\n手动安装 安装的机器系统是ubuntu22.04，1c1g的配置，在racknerd上购买的一个低配机器\nubuntu的包管理工具为apt，可以使用apt执行安装、更新、卸载应用等功能\n更新系统 登录机器之后，终端执行如下命令，查看系统版本\nlsb_release -a 可以看到如下输出，系统版本为ubuntu22.04 LTS(长期支持版本)\nNo LSB modules are available. Distributor ID:\tUbuntu Description:\tUbuntu 22.04.3 LTS Release:\t22.04 Codename:\tjammy 然后执行如下命令，先将系统的应用更新到最新版本,如果缺失其他的包，使用apt install进行安装即可\nsudo apt update \u0026\u0026 sudo apt upgrade 安装nginx 我们需要通过nginx访问wordpress页面，所以我们需要先安装一个nginx\n刚安装的系统没有自带nginx，系统提示我们可以自行安装\nroot@racknerd-7c9c56:~# nginx -v Command 'nginx' not found, but can be installed with: apt install nginx-core # version 1.18.0-6ubuntu14.4, or apt install nginx-extras # version 1.18.0-6ubuntu14.4 apt install nginx-light # version 1.18.0-6ubuntu14.4 执行如下命令安装nginx\nsudo apt install nginx 安装完之后查看nginx版本,可以看到不指定版本，默认是安装了1.18.0\nroot@racknerd-7c9c56:~# nginx -v nginx version: nginx/1.18.0 (Ubuntu) 查看nginx服务状态，当前服务状态正常\nroot@racknerd-7c9c56:~# sudo systemctl status nginx ● nginx.service - A high performance web server and a reverse proxy server Loaded: loaded (/lib/systemd/system/nginx.service; enabled; vendor preset: enabled) Active: active (running) since Tue 2023-12-12 13:20:47 UTC; 3min 15s ago Docs: man:nginx(8) Process: 1415 ExecStartPre=/usr/sbin/nginx -t -q -g daemon on; master_process on; (code=exited, status=0/SUCCESS) Process: 1416 ExecStart=/usr/sbin/nginx -g daemon on; master_process on; (code=exited, status=0/SUCCESS) Main PID: 1511 (nginx) Tasks: 2 (limit: 1013) Memory: 6.3M CPU: 50ms CGroup: /system.slice/nginx.service ├─1511 \"nginx: master process /usr/sbin/nginx -g daemon on; master_process on;\" └─1513 \"nginx: worker process\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" \"\" Dec 12 13:20:47 racknerd-7c9c56 systemd[1]: Starting A high performance web server and a reverse proxy server... Dec 12 13:20:47 racknerd-7c9c56 systemd[1]: Started A high performance web server and a reverse proxy server. 安装MySQL nginx安装好之后,我们需要安装mysql。 mysql是wordpress默认的数据库，如果想少折腾，安装mysql是最稳妥的方式。\n安装步骤 执行如下命令安装mysql\nsudo apt install mysql-server 安装好之后启动mysql服务\nsudo systemctl start mysql 启动之后查看mysql服务状态\nroot@racknerd-7c9c56:~# sudo systemctl status mysql ● mysql.service - MySQL Community Server Loaded: loaded (/lib/systemd/system/mysql.service; enabled; vendor preset: enabled) Active: active (running) since Tue 2023-12-12 13:28:53 UTC; 1min 57s ago Process: 2326 ExecStartPre=/usr/share/mysql/mysql-systemd-start pre (code=exited, status=0/SUCCESS) Main PID: 2334 (mysqld) Status: \"Server is operational\" Tasks: 37 (limit: 1013) Memory: 357.3M CPU: 3.053s CGroup: /system.slice/mysql.service └─2334 /usr/sbin/mysqld Dec 12 13:28:52 racknerd-7c9c56 systemd[1]: Starting MySQL Community Server... Dec 12 13:28:53 racknerd-7c9c56 systemd[1]: Started MySQL Community Server. 查看mysql版本，可以发现是8.0\nroot@racknerd-7c9c56:~# mysql -v Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 8 Server version: 8.0.35-0ubuntu0.22.04.1 (Ubuntu) Copyright (c) 2000, 2023, Oracle and/or its affiliates. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Reading history-file /root/.mysql_history Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. 安装以及启动之后我们需要为root用户设置密码，执行以下命令，会进行mysql终端\nsudo mysql 进入终端之后我们需要在终端为root用户创建密码,最后一\nroot@racknerd-7c9c56:~# sudo mysql Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 9 Server version: 8.0.35-0ubuntu0.22.04.1 (Ubuntu) Copyright (c) 2000, 2023, Oracle and/or its affiliates. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql\u003e ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password123'; 如下命令会修改root用户的密码为password123\nmysql\u003e ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'password123'; 修改好root密码之后退出\nmysql\u003e exit 然后使用账号密码重新登录，输入root密码会再次进入mysql终端\nmysql -u root -p 创建wordpress数据库 为wordpress创建一个数据库，用于存放wordpress数据\nmysql\u003e create database wordpress; Query OK, 1 row affected (0.01 sec) 安全配置(可选) 虽然是自用的机器和服务，不过安全服务还是要考虑一下，万一以后做大做强了呢\n命令行执行如下命令,会有一些交互\n需要不需要校验密码，需要的话下一步 密码强度级别选择，Low的话相当于弱密码，比较危险，级别越高，密码复杂度要求越高 是否更新root密码，更新之后会根据之前选择的密码校验级别，要求你输入新的root密码 是否需要移除匿名用户，移除之后登录mysql必须要使用密码了 是否需要禁用root远程登录，禁用之后只能在本机登录mysql 是否需要移除test库和其访问权限，移除之后就无法访问test库了 刷新权限之后以上修改则生效 root@racknerd-7c9c56:~# sudo mysql_secure_installation Securing the MySQL server deployment. Enter password for user root: VALIDATE PASSWORD COMPONENT can be used to test passwords and improve security. It checks the strength of password and allows the users to set only those passwords which are secure enough. Would you like to setup VALIDATE PASSWORD component? Press y|Y for Yes, any other key for No: y There are three levels of password validation policy: LOW Length \u003e= 8 MEDIUM Length \u003e= 8, numeric, mixed case, and special characters STRONG Length \u003e= 8, numeric, mixed case, special characters and dictionary file Please enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: 2 Using existing password for root. Estimated strength of the password: 50 Change the password for root ? ((Press y|Y for Yes, any other key for No) : y New password: Re-enter new password: Estimated strength of the password: 100 Do you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : y By default, a MySQL installation has an anonymous user, allowing anyone to log into MySQL without having to have a user account created for them. This is intended only for testing, and to make the installation go a bit smoother. You should remove them before moving into a production environment. Remove anonymous users? (Press y|Y for Yes, any other key for No) : y Success. Normally, root should only be allowed to connect from 'localhost'. This ensures that someone cannot guess at the root password from the network. Disallow root login remotely? (Press y|Y for Yes, any other key for No) : y Success. By default, MySQL comes with a database named 'test' that anyone can access. This is also intended only for testing, and should be removed before moving into a production environment. Remove test database and access to it? (Press y|Y for Yes, any other key for No) : y - Dropping test database... Success. - Removing privileges on test database... Success. Reloading the privilege tables will ensure that all changes made so far will take effect immediately. Reload privilege tables now? (Press y|Y for Yes, any other key for No) : y Success. All done! root@racknerd-7c9c56:~# sudo mysql ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: NO) root@racknerd-7c9c56:~# 以上mysql就安装好了，也为wordpress创建了一个库\n安装php 由于wordpress是php写的，所以需要在机器上安装php，目前最新的wordpress版本是6.4,安装php7.4就好了，不要安装8.0+的版本，\n感觉兼容有问题，折磨了我好久。\n先添加php仓库\nsudo add-apt-repository ppa:ondrej/php 执行到下面最后一行提示的时候按enter继续安装\nCAVEATS: 1. If you are using php-gearman, you need to add ppa:ondrej/pkg-gearman 2. If you are using apache2, you are advised to add ppa:ondrej/apache2 3. If you are using nginx, you are advised to add ppa:ondrej/nginx-mainline or ppa:ondrej/nginx PLEASE READ: If you like my work and want to give me a little motivation, please consider donating regularly: https://donate.sury.org/ WARNING: add-apt-repository is broken with non-UTF-8 locales, see https://github.com/oerdnj/deb.sury.org/issues/56 for workaround: # LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php More info: https://launchpad.net/~ondrej/+archive/ubuntu/php Adding repository. Press [ENTER] to continue or Ctrl-c to cancel. 上面执行完后，再执行以下命令安装php7.4以及相关插件和服务\nsudo apt install php7.4 php7.4-fpm php7.4-mysql php7.4-curl php7.4-xml 然后使用ps命令查看fpm服务是否启动,可以看到如下fpm服务以及在运行了\nroot@racknerd-7c9c56:~# ps -ef|grep fpm root 18996 1 0 14:04 ? 00:00:00 php-fpm: master process (/etc/php/7.4/fpm/php-fpm.conf) www-data 18997 18996 0 14:04 ? 00:00:00 php-fpm: pool www www-data 18998 18996 0 14:04 ? 00:00:00 php-fpm: pool www root 19118 2708 0 14:05 pts/0 00:00:00 grep --color=auto fpm 后面nginx需要通过unix socket访问，socket地址具体在/etc/php/7.4/fpm/pool.d/www.conf文件里，这个配置文件有如下几个配置项值得关注一下\nlisten = /run/php/php7.4-fpm.sock listen.owner = www-data listen.group = www-data ;listen.mode = 0660 listen = /run/php/php7.4-fpm.sock这个是后续要配置到nginx配置文件中的地址，nginx通过这个地址访问php-fpm服务，然后访问我们的wordpress文件。\nlisten支持unix和port 2种配置方式，二选一\nlisten = /run/php/php7.4-fpm.sock 或者\nlisten = 127.0.0.1:9000 这里配置成哪种格式后面Nginx就配哪种地址，我们这里就采用默认的unix socket的模式就行\nlister.owner和list.group以及list.mode这3个配置项涉及fpm进程的权限和用户组问题，nginx需要和这里保持一致，不然可能会报\n奇怪的文件权限问题。\n如上这几个配置项我们保持默认即可，不要去动。\n下载wordpress 其他的依赖组件都处理好之后，我们下载wordpress安装包，wordpress安装包可以去wordpress.org下载\n点击get wordpress，跳转到wordpress下载页\n下载页左边是wordpress的安装包下载地址，当前最新的版本是6.4.2，官方推荐使用php7.4+，mysql5.7+或者mariadb10.4+， mysql\n和mariadb算是同一个作者出品的，2者是兼容的，可以算同一种类型的数据库。\n下载页右边是主机厂商提供的付费解决方案，wordpress已经帮你搭好了，需要按需付费购买。我为了省钱以及可控，就选择了自己搭。\n安装包下载方式 那么wordpress安装包有2种下载方式\n第一种是浏览器页面点击下载，下载到本地之后，通过scp、ftp等方式上传到linux上 另一种是到机器上使用wget下载安装包 我这里使用第二种，右键复制链接地址，安装包下载地址为https://wordpress.org/latest.zip\n到机器上执行wget https://wordpress.org/latest.zip将安装包下载到linux机器上，这样下载会方便一点\nroot@racknerd-7c9c56:/opt# wget https://wordpress.org/latest.zip --2023-12-12 14:24:43-- https://wordpress.org/latest.zip Resolving wordpress.org (wordpress.org)... 198.143.164.252 Connecting to wordpress.org (wordpress.org)|198.143.164.252|:443... connected. HTTP request sent, awaiting response... 200 OK Length: 25954973 (25M) [application/zip] Saving to: ‘latest.zip’ latest.zip 100%[==================================================================================\u003e] 24.75M 30.0MB/s in 0.8s 2023-12-12 14:24:44 (30.0 MB/s) - ‘latest.zip’ saved [25954973/25954973] root@racknerd-7c9c56:/opt# ll total 25356 drwxr-xr-x 2 root root 4096 Dec 12 14:24 ./ drwxr-xr-x 19 root root 4096 Aug 10 2022 ../ -rw-r--r-- 1 root root 25954973 Dec 6 16:26 latest.zip 我将wordpress放在了opt目录，切忌wordpress不要放在/root目录，不然nginx会有奇怪的文件权限问题，解决不了的那种\n解压安装包 解压wordpress安装包，wordpress文件都在/opt/wordpess目录下\nsudo apt install unzip wordpress文件结构如下所示\n修改wordpress用户组和权限 这一步的权限比较重要，不然会有奇怪的权限问题，到opt目录下执行如下授权命令，解压之后wordpress目录的用户组都是root，需要\n修改为www-data:www-data，目录权限修改为755，需要用到chown和chmod命令， -R为递归执行所有的子目录和文件\n为何用户组要修改为www-data:www-data，因为php7.4-fpm的pool的用户组就是www-data:www-data\nroot@racknerd-7c9c56:/opt# pwd /opt root@racknerd-7c9c56:/opt# ll total 25360 drwxr-xr-x 3 root root 4096 Dec 12 14:27 ./ drwxr-xr-x 19 root root 4096 Aug 10 2022 ../ -rw-r--r-- 1 root root 25954973 Dec 6 16:26 latest.zip drwxr-xr-x 5 root root 4096 Dec 6 16:25 wordpress/ root@racknerd-7c9c56:/opt# sudo chown -R www-data:www-data wordpress/ root@racknerd-7c9c56:/opt# sudo chmod -R 755 wordpress/ root@racknerd-7c9c56:/opt# ll total 25360 drwxr-xr-x 3 root root 4096 Dec 12 14:27 ./ drwxr-xr-x 19 root root 4096 Aug 10 2022 ../ -rw-r--r-- 1 root root 25954973 Dec 6 16:26 latest.zip drwxr-xr-x 5 www-data www-data 4096 Dec 6 16:25 wordpress/ 生成wp-config.php 从wp-config-sample.php复制一份wp-config.php出来，修改里面的db配置，改为之前本地安装的Mysql的账号密码数据库。\n这一步如果不做的话，在安装页面会引导你填写配置生成一个wp-config.php文件。\nroot@racknerd-7c9c56:/opt/wordpress# cp wp-config-sample.php wp-config.php root@racknerd-7c9c56:/opt/wordpress# vi wp-config.php 配置nginx 下载好wordpress安装包之后，下面就是配置nginx访问wordpress了，这样就可以在浏览器页面访问wordpress安装页面\nnginx配置文件在/etc/nginx/nginx.conf，/etc/nginx/conf.d/用于放自定义配置文件，nginx版本为1.18.0\n自定义wordpress配置文件 不修改默认的配置文件，我们在/etc/nginx/conf.d目录下新建wordpress自己的配置文件\nroot@racknerd-7c9c56:/etc/nginx/conf.d# touch wp.conf root@racknerd-7c9c56:/etc/nginx/conf.d# vi wp.conf 将以下配置更新到wp.conf里,有几个比较重要的配置解释一下\nroot，这个地方配置的你的wordpress安装包的路径，配置错误会发生404等错误 server_name，这个如果没域名的话就配置localhost fastcgi_pass， 这个地方要配置fpm的服务地址，注意fpm的版本，由于安装的是7.4，所以fastcpgi配置的如下unix地址 修改好自己机器的实际配置，粘贴到wp.conf，执行:wp 保存配置\nserver { listen 80; root /opt/wordpress; index index.php index.html; server_name localhost; location / { try_files $uri $uri/ /index.php?$args; } location ~ \\.php$ { include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.4-fpm.sock; } location ~ /\\.ht { deny all; } location = /favicon.ico { log_not_found off; access_log off; } location = /robots.txt { allow all; log_not_found off; access_log off; } location ~* \\.(js|css|png|jpg|jpeg|gif|ico)$ { expires max; log_not_found off; } } 删除default配置 nginx安装好会有一个default配置，这个配置会影响我们自定义的配置，需要删掉或者重命名这个文件，文件路径为/etc/nginx/sites-available/default，执行以下步骤去掉default\n#在sites-enable目录备份default文件 root@racknerd-7c9c56:/etc/nginx/sites-available# mv default default.bak root@racknerd-7c9c56:/etc/nginx/sites-available# cd ../sites-enabled/ root@racknerd-7c9c56:/etc/nginx/sites-enabled# ll total 8 drwxr-xr-x 2 root root 4096 Dec 12 13:20 ./ drwxr-xr-x 8 root root 4096 Dec 12 14:31 ../ lrwxrwxrwx 1 root root 34 Dec 12 13:20 default -\u003e /etc/nginx/sites-available/default #在sites-enabled目录删掉软链接 root@racknerd-7c9c56:/etc/nginx/sites-enabled# rm -f default 确认nginx worker的用户 /etc/nginx/nginx.conf的第一行有关于Nginx user的设置，这个需要设置为www-data，和php7.4-fpm保持一致，nginx默认用户就是www-data，检查下即可\n验证配置 执行如下命令验证nginx配置文件是否正确\nroot@racknerd-7c9c56:/etc/nginx# nginx -t nginx: the configuration file /etc/nginx/nginx.conf syntax is ok nginx: configuration file /etc/nginx/nginx.conf test is successful 重启Nginx 配置文件验证没问题之后，重启Nginx\nsudo systemctl restart nginx 如果启动失败，执行以下2个命令排查错误原因\nsudo systemctl status nginx.service journalctl -xe nginx默认日志路径为/var/log/nginx/access.log和/var/log/nginx/error.log,也可以通过nginx日志排查问题\n安装wordpress 上面步骤一切顺利的话，接下来就到了安装wordpress的环节了，打开浏览器，输入以下地址，其中107.173.87.238是我机器的ip，80是nginx http的端口,替换为自己的ip即可\nhttp://107.173.87.238/wp-admin/install.php 进入安装页面，语言选择简体中文\n输入必要信息之后进行安装，密码可以自定义，也可以用wp生成的强密码\n之后进行登录，就会进入wordpress管理后台，装修自己的网站了\n配置ssl 上述步骤使用nginx+wordprss+mysql安装好了wordpress，已经可以访问了。\n为了网站安全性以及隐藏服务器ip，下面为我们的网站配置ssl以及域名解析。\n配置ss之后，所有的请求都会走https，安全会会得到很大的提高，通过域名访问，也会显得更加的专业，以及保护我们的服务器的ip，减\n少被黑的风险。配域名相比ip也比ip更容易记一点。\n前置依赖 一个属于你的域名，域名需要购买，便宜的比如godaddy上10块，20块左右就能买到一个域名了。其他的google,namecheap之类的也能买到。 一个dns解析器，将域名解析到服务器ip。一般域名厂商都有这个功能。 我个人比较喜欢cloudflare，功能强大，国际知名大厂，个人免费，还好使，支持中文，还能生成免费的ssl证书。\n接下来以cloudflare为例，介绍如何配置域名解析，生成ssl证书，以及Nginx如何配置ssl。\n生成ssl证书 没账号的可以先注册一个cloudflare账号，用邮箱注册。\n打开cloudflare控制台，需要先将域名托管到cloudflare，才能配置域名解析。其他厂商自行搜索解决。\n选中要配置解析的域名，打开左侧的SSL/TLS，选中源服务器，右侧点击创建证书。这个证书是用来安装到服务器上的。\n进入创建页面，会有一些选项，默认即可。主机名对应nginx server{}块里的server_name，可以自定义，创建证书的时候和服务器上配\n置的server_name保持一致即可。支持通配符。证书有效期最长是15年，够用了。\n点击创建之后，会生成一个key和pem文件。key和pem都是要保存下来放到服务器上的。\n私钥只有这一次机会可以复制，关闭这个页面之后就找不到了，所以私钥需要妥善保管，丢失或者遗忘只能重新创建证书了。\n和私钥不同，pem文件之后还可以下载。\n将源证书内容复制，粘贴到xxx.pem文件里。\n将私钥复制，粘贴到xxx.key里。\n点击确定之后，会回到证书页面，可以看到，只能下载pem文件，key文件被隐藏，无法下载与访问了\nnginx配置强制跳转https 前面几步，我们监听了80端口，这是Nginx的http接口，现在我们要监听443端口(https)，将80端口的请求强制跳转到443端口。\n首先进入/etc/nginx/config.d/目录，将wp.conf重命名为wp.conf.bak，这样原先的文件就不生效了。\n然后执行touch wp.conf，重新生成空白的wp.conf文件\ncd /etc/nginx/config.d mv wp.conf wp.conf.bak touch wp.conf 然后将下方的配置文件修改后粘贴到wp.conf里\n有如下几次地方需要改成你自己的配置\n2个server块里的server_name，这个地方要配置为上一步创建证书时选择的主机名，我这里要保护的是三级域名，符合通配条件 记得将ssl_certificate和ssl_certificate_key的位置配置正确 这个域名的日志重新写到新的文件名了，按需放开或者注释掉 其他的配置和之前80的配置一致，没有改动\n# Redirect HTTP -\u003e HTTPS server { listen 80; server_name www.racknerd.thend03.com racknerd.thend03.com; return 301 https://$host$request_uri; } server{ listen 443 ssl http2; server_name www.racknerd.thend03.com racknerd.thend03.com; root /opt/wordpress; index index.php index.html; # SSL parameters ssl_certificate /root/thend03.com.pem; ssl_certificate_key /root/thend03.com.key; # log files access_log /var/log/nginx/resource.thend03.com.access.log; error_log /var/log/nginx/resource.thend03.com.error.log; location = /favicon.ico { log_not_found off; access_log off; } location = /robots.txt { allow all; log_not_found off; access_log off; } location / { try_files $uri $uri/ /index.php?$args; } location ~ \\.php$ { include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.4-fpm.sock; } location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg)$ { expires max; log_not_found off; } } 在服务器生成证书 基于上面nginx证书的路径配置，在/root目录生成key和pem证书,并且编辑文件，将在cloudflare页面上生成的key和pem字符串复制到对应的文件里。\nroot@racknerd-7c9c56:/etc/nginx/conf.d# cd /root root@racknerd-7c9c56:~# touch thend03.com.pem root@racknerd-7c9c56:~# touch thend03.com.key root@racknerd-7c9c56:~# vi thend03.com.pem root@racknerd-7c9c56:~# vi thend03.com.key 重启nginx 配置好nginx 443配置文件后，执行命令重启nginx\nroot@racknerd-7c9c56:~# sudo systemctl restart nginx cloudflare配置域名解析 nginx处理好之后，回到cloudflare页面，配置域名到ip的解析，添加一条A记录，就可以在访问域名的时候请求到后端服务器。\n添加好之后，在域名管理那可以看到最新添加的解析记录\n配置ssl/tls客户端策略 打开SSL/TLS概述，设置下客户端策略，这里选择端到端，加密等级比较高，并且我们使用的是自签名的证书\n浏览器访问 解析配置好之后，就是浏览器使用域名访问了。\n访问wp-admin管理后台，这时会跳转到ip，需要我们登录进去之后设置一下\n可以看到域名跳转到了ip\n打开设置，可以看到现在的站点还是ip的方式。需要修改为域名。\n再次登录，地址栏就还是域名，没有变成ip。以后都可以用域名的方式访问了。\n至此，wordpress的手动部署就告一段落了。后续再介绍宝塔面板，docker,docker-compose之类的安装部署。\n以及如何选择模板搭建自己的目标站。\n参考链接 wordpress+postgresql\npg4wp plugin\ndebian安装php8.1\nubuntu安装mysql\ndebian安装mysql\nubuntu18.04安装wordpress\nnginx+wordpress ssl配置\nwordpress经典五步安装法\n","wordCount":"8491","inLanguage":"zh","datePublished":"2023-12-12T08:43:49+08:00","dateModified":"2023-12-12T08:43:49+08:00","author":{"@type":"Person","name":"since"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.thend03.com/posts/install-wordpress-on-ubuntu22.04/"},"publisher":{"@type":"Organization","name":"Fayy\u0026Fc's Blog","logo":{"@type":"ImageObject","url":"https://blog.thend03.com/img/logo.jpg"}}}</script></head><body id=top><script>(function(){let e,t=new RegExp("(^| )change-themes=([^;]*)(;|$)");(e=document.cookie.match(t))||((new Date).getHours()>=19||(new Date).getHours()<6?(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")):(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")))})(),localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.thend03.com/ accesskey=h title="fayy&amp;fc (Alt + H)"><img src=https://blog.thend03.com/img/logo.jpg alt=logo aria-label=logo height=35>fayy&amp;fc</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://blog.thend03.com/search title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li><a href=https://blog.thend03.com/ title="🏠 主页"><span>🏠 主页</span></a></li><li><a href=https://blog.thend03.com/archives/ title="⏱️ 归档"><span>⏱️ 归档</span></a></li><li><a href=https://blog.thend03.com/tags title="🧩 标签"><span>🧩 标签</span></a></li><li><a href=https://blog.thend03.com/about title="🙋🏻‍♂️ 关于"><span>🙋🏻‍♂️ 关于</span></a></li><li><a href=https://blog.thend03.com/links title="🤝 友链"><span>🤝 友链</span></a></li></ul></nav></header><main class="main page"><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}</style><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://blog.thend03.com/>🏠 主页</a>&nbsp;»&nbsp;<a href=https://blog.thend03.com/posts/>📚文章</a></div><h1 class=post-title>Ubuntu22.04安装wordpress</h1><div class=post-description>如何在ubuntu22.04上安装wordpress</div><div class=post-meta><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}.parent-post-meta{display:flex;flex-wrap:wrap;opacity:.8}</style><span class=parent-post-meta><span id=post_meta_style_1><span class="fa fa-calendar-check-o"></span>
<span>2023-12-12
&nbsp;&nbsp;
</span></span><span id=post_meta_style_3><span class="fa fa-file-word-o"></span>
<span>8491字
&nbsp;&nbsp;
</span></span><span id=post_meta_style_4><span class="fa fa-clock-o"></span>
<span>17分钟
&nbsp;&nbsp;
</span></span><span id=post_meta_style_5><span class="fa fa-user-o"></span>
<span>since
&nbsp;&nbsp;
</span></span><span id=post_meta_style_6><span class="fa fa-tags" style=opacity:.8></span>
<span><span class=post-tags-meta><a href=https://blog.thend03.com/tags/wordpress/ style=color:var(--secondary)!important>Wordpress</a>
</span></span></span></span><span style=opacity:.8><span id=post_meta_style_7>&nbsp;&nbsp;
<span class="fa fa-eye"></span>
<span><span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span>
&nbsp;&nbsp;
</span></span><span id=post_meta_style_8><span class="fa fa-commenting-o"></span>
<span><script src=https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js></script><script>let url=document.documentURI,dnsUrl="https://blog.thend03.com/",urlSplit=url.split(dnsUrl),finalUrl=urlSplit[1];finalUrl[0]!=="/"&&(finalUrl="/"+finalUrl),twikoo.getCommentsCount({envId:null,region:null,urls:[finalUrl],includeReply:!1}).then(function(e){let t=e[0].count;const n=document.getElementById("comment_count");n.innerText=t}).catch(function(e){console.error(e)})</script><span id=comment_count></span></span></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=前言>前言</a></li><li><a href=#%e9%81%87%e5%88%b0%e7%9a%84%e5%9d%91 aria-label=遇到的坑>遇到的坑</a><ul><li><a href=#php%e7%89%88%e6%9c%ac%e8%bf%87%e9%ab%98%e7%9a%84%e9%97%ae%e9%a2%98 aria-label=php版本过高的问题>php版本过高的问题</a></li><li><a href=#%e5%ae%89%e8%a3%85%e6%96%87%e6%a1%a3%e7%bc%ba%e5%a4%b1%e5%85%b3%e9%94%ae%e6%ad%a5%e9%aa%a4 aria-label=安装文档缺失关键步骤>安装文档缺失关键步骤</a></li><li><a href=#%e6%96%87%e4%bb%b6%e6%9d%83%e9%99%90%e9%97%ae%e9%a2%98 aria-label=文件权限问题>文件权限问题</a></li></ul></li><li><a href=#%e5%89%8d%e7%bd%ae%e4%be%9d%e8%b5%96 aria-label=前置依赖>前置依赖</a></li><li><a href=#%e6%89%8b%e5%8a%a8%e5%ae%89%e8%a3%85 aria-label=手动安装>手动安装</a><ul><li><a href=#%e6%9b%b4%e6%96%b0%e7%b3%bb%e7%bb%9f aria-label=更新系统>更新系统</a></li><li><a href=#%e5%ae%89%e8%a3%85nginx aria-label=安装nginx>安装nginx</a></li><li><a href=#%e5%ae%89%e8%a3%85mysql aria-label=安装MySQL>安装MySQL</a><ul><li><a href=#%e5%ae%89%e8%a3%85%e6%ad%a5%e9%aa%a4 aria-label=安装步骤>安装步骤</a></li><li><a href=#%e5%88%9b%e5%bb%bawordpress%e6%95%b0%e6%8d%ae%e5%ba%93 aria-label=创建wordpress数据库>创建wordpress数据库</a></li><li><a href=#%e5%ae%89%e5%85%a8%e9%85%8d%e7%bd%ae%e5%8f%af%e9%80%89 aria-label=安全配置(可选)>安全配置(可选)</a></li></ul></li><li><a href=#%e5%ae%89%e8%a3%85php aria-label=安装php>安装php</a></li><li><a href=#%e4%b8%8b%e8%bd%bdwordpress aria-label=下载wordpress>下载wordpress</a><ul><li><a href=#%e5%ae%89%e8%a3%85%e5%8c%85%e4%b8%8b%e8%bd%bd%e6%96%b9%e5%bc%8f aria-label=安装包下载方式>安装包下载方式</a></li><li><a href=#%e8%a7%a3%e5%8e%8b%e5%ae%89%e8%a3%85%e5%8c%85 aria-label=解压安装包>解压安装包</a></li><li><a href=#%e4%bf%ae%e6%94%b9wordpress%e7%94%a8%e6%88%b7%e7%bb%84%e5%92%8c%e6%9d%83%e9%99%90 aria-label=修改wordpress用户组和权限>修改wordpress用户组和权限</a></li><li><a href=#%e7%94%9f%e6%88%90wp-configphp aria-label=生成wp-config.php>生成wp-config.php</a></li></ul></li><li><a href=#%e9%85%8d%e7%bd%aenginx aria-label=配置nginx>配置nginx</a><ul><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89wordpress%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6 aria-label=自定义wordpress配置文件>自定义wordpress配置文件</a></li><li><a href=#%e5%88%a0%e9%99%a4default%e9%85%8d%e7%bd%ae aria-label=删除default配置>删除default配置</a></li><li><a href=#%e7%a1%ae%e8%ae%a4nginx-worker%e7%9a%84%e7%94%a8%e6%88%b7 aria-label="确认nginx worker的用户">确认nginx worker的用户</a></li><li><a href=#%e9%aa%8c%e8%af%81%e9%85%8d%e7%bd%ae aria-label=验证配置>验证配置</a></li><li><a href=#%e9%87%8d%e5%90%afnginx aria-label=重启Nginx>重启Nginx</a></li></ul></li><li><a href=#%e5%ae%89%e8%a3%85wordpress aria-label=安装wordpress>安装wordpress</a></li><li><a href=#%e9%85%8d%e7%bd%aessl aria-label=配置ssl>配置ssl</a><ul><li><a href=#%e5%89%8d%e7%bd%ae%e4%be%9d%e8%b5%96-1 aria-label=前置依赖>前置依赖</a></li><li><a href=#%e7%94%9f%e6%88%90ssl%e8%af%81%e4%b9%a6 aria-label=生成ssl证书>生成ssl证书</a></li><li><a href=#nginx%e9%85%8d%e7%bd%ae%e5%bc%ba%e5%88%b6%e8%b7%b3%e8%bd%achttps aria-label=nginx配置强制跳转https>nginx配置强制跳转https</a></li><li><a href=#%e5%9c%a8%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%94%9f%e6%88%90%e8%af%81%e4%b9%a6 aria-label=在服务器生成证书>在服务器生成证书</a></li><li><a href=#%e9%87%8d%e5%90%afnginx-1 aria-label=重启nginx>重启nginx</a></li><li><a href=#cloudflare%e9%85%8d%e7%bd%ae%e5%9f%9f%e5%90%8d%e8%a7%a3%e6%9e%90 aria-label=cloudflare配置域名解析>cloudflare配置域名解析</a></li><li><a href=#%e9%85%8d%e7%bd%aessltls%e5%ae%a2%e6%88%b7%e7%ab%af%e7%ad%96%e7%95%a5 aria-label=配置ssl/tls客户端策略>配置ssl/tls客户端策略</a></li><li><a href=#%e6%b5%8f%e8%a7%88%e5%99%a8%e8%ae%bf%e9%97%ae aria-label=浏览器访问>浏览器访问</a></li></ul></li></ul></li><li><a href=#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5 aria-label=参考链接>参考链接</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{elements&&(activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")}))},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h2><p>最近在研究建站的事情，wordpress不论从保有量还是生态丰富的层面，并且作为一个老牌的开源系统，解决方案非常丰富，所以我打</p><p>算使用wordpress作为建站工具，研究下如何使用wordpress建站。</p><p>研究过程中踩了不少的坑，记录下，提供下简洁明了可用的安装过程。</p><h2 id=遇到的坑>遇到的坑<a hidden class=anchor aria-hidden=true href=#遇到的坑>#</a></h2><h3 id=php版本过高的问题>php版本过高的问题<a hidden class=anchor aria-hidden=true href=#php版本过高的问题>#</a></h3><p>本来买的1c1g的小水管机器，为了节约机器，打算使用免费的数据库云服务。</p><p>找到了2个产品，分别的plantscale和supabase，第一个是mysql的云服务，但是要绑信用卡，就放弃了。第二个是postgressql,免费的服务，不需要绑定信用卡，所以就注册了一个pg库。</p><p>我在冲浪的时候看到别人也推荐pg，占用资源少，性能更好，所以我也倾向于使用</p><p>然后磨人的就来了，由于wordpress原生只支持MySQL，想使用pg就得找个插件，这一步就掉坑里了，我冲浪的时候发现pg4wp这个插</p><p>件最新版需要php8.1以上，然后安装这个插件之后各种连接超时，权限问题，我是真的被折磨的有点惨。</p><p>通过Nginx访问wp-admin/install.php，报错connection timeout，各种搜索解决不了。后来灵机一动，把pg4wp插件挪走，php版本从</p><p>8.2降到7.4就好了。。。。</p><p>嘿，果然安装还是按照文档来，切忌一上来就想法比较多，使用其他最新的组件，比如pg。</p><p><em><strong>各种403，404，502，504，搜遍英文网站找不到结果，试了又试，错误依旧，绝望，我都有点怀疑自己了。</strong></em></p><p>wordpress6.4.2要求php7.4+，但是pg4wp要求php8.1+，虽然一般会版本向下兼容，但是不兼容的事还是被我遇到了,看pg4wp的</p><p>readme，在6.4.1上通过了兼容性测试，6.4.2就多了一个小版本，真的是。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122220460.png alt=image-20231212222005424></p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142225048.png alt=image-20231214222557896></p><h3 id=安装文档缺失关键步骤>安装文档缺失关键步骤<a hidden class=anchor aria-hidden=true href=#安装文档缺失关键步骤>#</a></h3><p>wordpress有一个经典的五步安装法，但是缺少了一些关键的描述，比如如何访问install.php，文档介绍是使用web服务器，但具体怎么</p><p>做没有详细介绍，导致我进去就掉坑里了。还有一些其他的细节没有补充。</p><p>而且基本是英文文档，看下来略微有点吃力。</p><p>这是wordpress开发者网站的安装步骤，我最需要的一步，如何在浏览器里访问install.php没写，让你用web浏览器去访问，用apache还</p><p>是用nginx还是别的，一点都没写。</p><p>英文文档看下来还是要点时间的。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142228755.png alt=image-20231214222836660></p><h3 id=文件权限问题>文件权限问题<a hidden class=anchor aria-hidden=true href=#文件权限问题>#</a></h3><p>由于是使用root用户登录的，所以我第一次安装目录是/root/wordpress，nginx访问报文件权限问题，挪到非root目录nginx访问就正常了。</p><p>所以省事起见，wordpress不要放在root。</p><p>另外wordpress目录的用户组和目录权限需要为www-data:www-data和755。其中www-data是php7.4-fpm进程的用户组。</p><p>本篇文章力求把一些配置，关键步骤解释清楚，不踩无谓的坑。</p><h2 id=前置依赖>前置依赖<a hidden class=anchor aria-hidden=true href=#前置依赖>#</a></h2><p>Wordpress是一个服务，需要我们部署服务之后去访问wordpress的页面，最少需要一台机器部署wordpress整套服务.</p><p>如果需要使用域名访问的话，还需要买一个域名，解析到我们机器的ip上才行。</p><p>wordpress自身需要如下的组件</p><ul><li>一台linux机器，我这次安装的机器版本是ubuntu222.04</li><li>wordpress安装包，在wordpress.org下载最新的安装包，最新版本是6.4.2</li><li>机器上安装了php，版本最好是7.4</li><li>一个可用的mysql服务，版本需要5.7或者8.0+或者对应版本的mariadb(和mysql同一个作者)</li><li>机器上安装Nginx，nginx版本为1.18.0+</li></ul><p>如果需要域名访问，则需要购买一个域名，购买域名之后解析到自己的linux机器上</p><ul><li>购买一个域名</li><li>将域名解析到linux机器所在ip</li></ul><p>以下将基于如上的依赖条件，逐步进行安装</p><h2 id=手动安装>手动安装<a hidden class=anchor aria-hidden=true href=#手动安装>#</a></h2><p>安装的机器系统是ubuntu22.04，1c1g的配置，在racknerd上购买的一个低配机器</p><p>ubuntu的包管理工具为apt，可以使用apt执行安装、更新、卸载应用等功能</p><h3 id=更新系统>更新系统<a hidden class=anchor aria-hidden=true href=#更新系统>#</a></h3><p>登录机器之后，终端执行如下命令，查看系统版本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>lsb_release -a
</span></span></code></pre></div><p>可以看到如下输出，系统版本为ubuntu22.04 LTS(长期支持版本)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>
</span></span><span style=display:flex><span>No LSB modules are available.
</span></span><span style=display:flex><span>Distributor ID:	Ubuntu
</span></span><span style=display:flex><span>Description:	Ubuntu 22.04.3 LTS
</span></span><span style=display:flex><span>Release:	22.04
</span></span><span style=display:flex><span>Codename:	jammy
</span></span></code></pre></div><p>然后执行如下命令，先将系统的应用更新到最新版本,如果缺失其他的包，使用apt install进行安装即可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt upgrade
</span></span></code></pre></div><h3 id=安装nginx>安装nginx<a hidden class=anchor aria-hidden=true href=#安装nginx>#</a></h3><p>我们需要通过nginx访问wordpress页面，所以我们需要先安装一个nginx</p><p>刚安装的系统没有自带nginx，系统提示我们可以自行安装</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:~# nginx -v
</span></span><span style=display:flex><span>Command &#39;nginx&#39; not found, but can be installed with:
</span></span><span style=display:flex><span>apt install nginx-core    # version 1.18.0-6ubuntu14.4, or
</span></span><span style=display:flex><span>apt install nginx-extras  # version 1.18.0-6ubuntu14.4
</span></span><span style=display:flex><span>apt install nginx-light   # version 1.18.0-6ubuntu14.4
</span></span></code></pre></div><p>执行如下命令安装nginx</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt install nginx
</span></span></code></pre></div><p>安装完之后查看nginx版本,可以看到不指定版本，默认是安装了1.18.0</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:~# nginx -v
</span></span><span style=display:flex><span>nginx version: nginx/1.18.0 (Ubuntu)
</span></span></code></pre></div><p>查看nginx服务状态，当前服务状态正常</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>root<span style=color:#960050;background-color:#1e0010>@</span>racknerd<span style=color:#f92672>-</span><span style=color:#ae81ff>7</span>c9c56:<span style=color:#f92672>~</span><span style=color:#75715e># sudo systemctl status nginx</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>●</span> nginx<span style=color:#f92672>.</span>service <span style=color:#f92672>-</span> A high performance web server <span style=color:#f92672>and</span> a reverse proxy server
</span></span><span style=display:flex><span>     Loaded: loaded (<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>systemd<span style=color:#f92672>/</span>system<span style=color:#f92672>/</span>nginx<span style=color:#f92672>.</span>service; enabled; vendor preset: enabled)
</span></span><span style=display:flex><span>     Active: active (running) since Tue <span style=color:#ae81ff>2023</span><span style=color:#f92672>-</span><span style=color:#ae81ff>12</span><span style=color:#f92672>-</span><span style=color:#ae81ff>12</span> <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>47</span> UTC; <span style=color:#ae81ff>3</span>min <span style=color:#ae81ff>15</span>s ago
</span></span><span style=display:flex><span>       Docs: man:nginx(<span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>    Process: <span style=color:#ae81ff>1415</span> ExecStartPre<span style=color:#f92672>=/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nginx <span style=color:#f92672>-</span>t <span style=color:#f92672>-</span>q <span style=color:#f92672>-</span>g daemon on; master_process on; (code<span style=color:#f92672>=</span>exited, status<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>/</span>SUCCESS)
</span></span><span style=display:flex><span>    Process: <span style=color:#ae81ff>1416</span> ExecStart<span style=color:#f92672>=/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nginx <span style=color:#f92672>-</span>g daemon on; master_process on; (code<span style=color:#f92672>=</span>exited, status<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>/</span>SUCCESS)
</span></span><span style=display:flex><span>   Main PID: <span style=color:#ae81ff>1511</span> (nginx)
</span></span><span style=display:flex><span>      Tasks: <span style=color:#ae81ff>2</span> (limit: <span style=color:#ae81ff>1013</span>)
</span></span><span style=display:flex><span>     Memory: <span style=color:#ae81ff>6.3</span>M
</span></span><span style=display:flex><span>        CPU: <span style=color:#ae81ff>50</span>ms
</span></span><span style=display:flex><span>     CGroup: <span style=color:#f92672>/</span>system<span style=color:#f92672>.</span>slice<span style=color:#f92672>/</span>nginx<span style=color:#f92672>.</span>service
</span></span><span style=display:flex><span>             <span style=color:#960050;background-color:#1e0010>├─</span><span style=color:#ae81ff>1511</span> <span style=color:#e6db74>&#34;nginx: master process /usr/sbin/nginx -g daemon on; master_process on;&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#960050;background-color:#1e0010>└─</span><span style=color:#ae81ff>1513</span> <span style=color:#e6db74>&#34;nginx: worker process&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Dec <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>47</span> racknerd<span style=color:#f92672>-</span><span style=color:#ae81ff>7</span>c9c56 systemd[<span style=color:#ae81ff>1</span>]: Starting A high performance web server <span style=color:#f92672>and</span> a reverse proxy server<span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>Dec <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>47</span> racknerd<span style=color:#f92672>-</span><span style=color:#ae81ff>7</span>c9c56 systemd[<span style=color:#ae81ff>1</span>]: Started A high performance web server <span style=color:#f92672>and</span> a reverse proxy server<span style=color:#f92672>.</span>
</span></span></code></pre></div><img src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122125209.png alt=image-20231212212504858 style=zoom:50%><h3 id=安装mysql>安装MySQL<a hidden class=anchor aria-hidden=true href=#安装mysql>#</a></h3><p>nginx安装好之后,我们需要安装mysql。 mysql是wordpress默认的数据库，如果想少折腾，安装mysql是最稳妥的方式。</p><h4 id=安装步骤>安装步骤<a hidden class=anchor aria-hidden=true href=#安装步骤>#</a></h4><p>执行如下命令安装mysql</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt install mysql-server
</span></span></code></pre></div><p>安装好之后启动mysql服务</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo systemctl start mysql
</span></span></code></pre></div><p>启动之后查看mysql服务状态</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>root<span style=color:#960050;background-color:#1e0010>@</span>racknerd<span style=color:#f92672>-</span><span style=color:#ae81ff>7</span>c9c56:<span style=color:#f92672>~</span><span style=color:#75715e># sudo systemctl status mysql</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>●</span> mysql<span style=color:#f92672>.</span>service <span style=color:#f92672>-</span> MySQL Community Server
</span></span><span style=display:flex><span>     Loaded: loaded (<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>systemd<span style=color:#f92672>/</span>system<span style=color:#f92672>/</span>mysql<span style=color:#f92672>.</span>service; enabled; vendor preset: enabled)
</span></span><span style=display:flex><span>     Active: active (running) since Tue <span style=color:#ae81ff>2023</span><span style=color:#f92672>-</span><span style=color:#ae81ff>12</span><span style=color:#f92672>-</span><span style=color:#ae81ff>12</span> <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>:<span style=color:#ae81ff>53</span> UTC; <span style=color:#ae81ff>1</span>min <span style=color:#ae81ff>57</span>s ago
</span></span><span style=display:flex><span>    Process: <span style=color:#ae81ff>2326</span> ExecStartPre<span style=color:#f92672>=/</span>usr<span style=color:#f92672>/</span>share<span style=color:#f92672>/</span>mysql<span style=color:#f92672>/</span>mysql<span style=color:#f92672>-</span>systemd<span style=color:#f92672>-</span>start pre (code<span style=color:#f92672>=</span>exited, status<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#f92672>/</span>SUCCESS)
</span></span><span style=display:flex><span>   Main PID: <span style=color:#ae81ff>2334</span> (mysqld)
</span></span><span style=display:flex><span>     Status: <span style=color:#e6db74>&#34;Server is operational&#34;</span>
</span></span><span style=display:flex><span>      Tasks: <span style=color:#ae81ff>37</span> (limit: <span style=color:#ae81ff>1013</span>)
</span></span><span style=display:flex><span>     Memory: <span style=color:#ae81ff>357.3</span>M
</span></span><span style=display:flex><span>        CPU: <span style=color:#ae81ff>3.053</span>s
</span></span><span style=display:flex><span>     CGroup: <span style=color:#f92672>/</span>system<span style=color:#f92672>.</span>slice<span style=color:#f92672>/</span>mysql<span style=color:#f92672>.</span>service
</span></span><span style=display:flex><span>             <span style=color:#960050;background-color:#1e0010>└─</span><span style=color:#ae81ff>2334</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>mysqld
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Dec <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>:<span style=color:#ae81ff>52</span> racknerd<span style=color:#f92672>-</span><span style=color:#ae81ff>7</span>c9c56 systemd[<span style=color:#ae81ff>1</span>]: Starting MySQL Community Server<span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>Dec <span style=color:#ae81ff>12</span> <span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>28</span>:<span style=color:#ae81ff>53</span> racknerd<span style=color:#f92672>-</span><span style=color:#ae81ff>7</span>c9c56 systemd[<span style=color:#ae81ff>1</span>]: Started MySQL Community Server<span style=color:#f92672>.</span>
</span></span></code></pre></div><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122131389.png alt=image-20231212213110357></p><p>查看mysql版本，可以发现是8.0</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:~# mysql -v
</span></span><span style=display:flex><span>Welcome to the MySQL monitor.  Commands end with ; or \g.
</span></span><span style=display:flex><span>Your MySQL connection id is 8
</span></span><span style=display:flex><span>Server version: 8.0.35-0ubuntu0.22.04.1 (Ubuntu)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Copyright (c) 2000, 2023, Oracle and/or its affiliates.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Oracle is a registered trademark of Oracle Corporation and/or its
</span></span><span style=display:flex><span>affiliates. Other names may be trademarks of their respective
</span></span><span style=display:flex><span>owners.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Reading history-file /root/.mysql_history
</span></span><span style=display:flex><span>Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.
</span></span></code></pre></div><p>安装以及启动之后我们需要为root用户设置密码，执行以下命令，会进行mysql终端</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo mysql
</span></span></code></pre></div><p>进入终端之后我们需要在终端为root用户创建密码,最后一</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>root@racknerd-7c9c56:~# sudo mysql
</span></span><span style=display:flex><span>Welcome to the MySQL monitor.  Commands end with ; or <span style=color:#ae81ff>\g</span>.
</span></span><span style=display:flex><span>Your MySQL connection id is <span style=color:#ae81ff>9</span>
</span></span><span style=display:flex><span>Server version: 8.0.35-0ubuntu0.22.04.1 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> 2000, 2023, Oracle and/or its affiliates.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Oracle is a registered trademark of Oracle Corporation and/or its
</span></span><span style=display:flex><span>affiliates. Other names may be trademarks of their respective
</span></span><span style=display:flex><span>owners.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#39;help;&#39;</span> or <span style=color:#e6db74>&#39;\h&#39;</span> <span style=color:#66d9ef>for</span> help. Type <span style=color:#e6db74>&#39;\c&#39;</span> to clear the current input statement.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; ALTER USER <span style=color:#e6db74>&#39;root&#39;</span>@<span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED WITH mysql_native_password BY <span style=color:#e6db74>&#39;password123&#39;</span>;
</span></span></code></pre></div><p>如下命令会修改root用户的密码为password123</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;root&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;localhost&#39;</span> IDENTIFIED <span style=color:#66d9ef>WITH</span> mysql_native_password <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;password123&#39;</span>;
</span></span></code></pre></div><p>修改好root密码之后退出</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>mysql&gt; exit
</span></span></code></pre></div><p>然后使用账号密码重新登录，输入root密码会再次进入mysql终端</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span> mysql -u root -p
</span></span></code></pre></div><h4 id=创建wordpress数据库>创建wordpress数据库<a hidden class=anchor aria-hidden=true href=#创建wordpress数据库>#</a></h4><p>为wordpress创建一个数据库，用于存放wordpress数据</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span>mysql<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>create</span> <span style=color:#66d9ef>database</span> wordpress;
</span></span><span style=display:flex><span>Query OK, <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>row</span> affected (<span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>01</span> sec)
</span></span></code></pre></div><h4 id=安全配置可选>安全配置(可选)<a hidden class=anchor aria-hidden=true href=#安全配置可选>#</a></h4><p>虽然是自用的机器和服务，不过安全服务还是要考虑一下，万一以后做大做强了呢</p><p>命令行执行如下命令,会有一些交互</p><ul><li>需要不需要校验密码，需要的话下一步</li><li>密码强度级别选择，Low的话相当于弱密码，比较危险，级别越高，密码复杂度要求越高</li><li>是否更新root密码，更新之后会根据之前选择的密码校验级别，要求你输入新的root密码</li><li>是否需要移除匿名用户，移除之后登录mysql必须要使用密码了</li><li>是否需要禁用root远程登录，禁用之后只能在本机登录mysql</li><li>是否需要移除test库和其访问权限，移除之后就无法访问test库了</li><li>刷新权限之后以上修改则生效</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>root@racknerd-7c9c56:~# sudo mysql_secure_installation
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Securing the MySQL server deployment.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter password <span style=color:#66d9ef>for</span> user root:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VALIDATE PASSWORD COMPONENT can be used to test passwords
</span></span><span style=display:flex><span>and improve security. It checks the strength of password
</span></span><span style=display:flex><span>and allows the users to set only those passwords which are
</span></span><span style=display:flex><span>secure enough. Would you like to setup VALIDATE PASSWORD component?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Press y|Y <span style=color:#66d9ef>for</span> Yes, any other key <span style=color:#66d9ef>for</span> No: y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>There are three levels of password validation policy:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LOW    Length &gt;<span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>MEDIUM Length &gt;<span style=color:#f92672>=</span> 8, numeric, mixed <span style=color:#66d9ef>case</span>, and special characters
</span></span><span style=display:flex><span>STRONG Length &gt;<span style=color:#f92672>=</span> 8, numeric, mixed <span style=color:#66d9ef>case</span>, special characters and dictionary                  file
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Please enter 0 <span style=color:#f92672>=</span> LOW, 1 <span style=color:#f92672>=</span> MEDIUM and 2 <span style=color:#f92672>=</span> STRONG: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>Using existing password <span style=color:#66d9ef>for</span> root.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Estimated strength of the password: <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span>Change the password <span style=color:#66d9ef>for</span> root ? <span style=color:#f92672>((</span>Press y|Y <span style=color:#66d9ef>for</span> Yes, any other key <span style=color:#66d9ef>for</span> No<span style=color:#f92672>)</span> : y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>New password:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Re-enter new password:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Estimated strength of the password: <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>Do you wish to <span style=color:#66d9ef>continue</span> with the password provided?<span style=color:#f92672>(</span>Press y|Y <span style=color:#66d9ef>for</span> Yes, any other key <span style=color:#66d9ef>for</span> No<span style=color:#f92672>)</span> : y
</span></span><span style=display:flex><span>By default, a MySQL installation has an anonymous user,
</span></span><span style=display:flex><span>allowing anyone to log into MySQL without having to have
</span></span><span style=display:flex><span>a user account created <span style=color:#66d9ef>for</span> them. This is intended only <span style=color:#66d9ef>for</span>
</span></span><span style=display:flex><span>testing, and to make the installation go a bit smoother.
</span></span><span style=display:flex><span>You should remove them before moving into a production
</span></span><span style=display:flex><span>environment.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Remove anonymous users? <span style=color:#f92672>(</span>Press y|Y <span style=color:#66d9ef>for</span> Yes, any other key <span style=color:#66d9ef>for</span> No<span style=color:#f92672>)</span> : y
</span></span><span style=display:flex><span>Success.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Normally, root should only be allowed to connect from
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;localhost&#39;</span>. This ensures that someone cannot guess at
</span></span><span style=display:flex><span>the root password from the network.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Disallow root login remotely? <span style=color:#f92672>(</span>Press y|Y <span style=color:#66d9ef>for</span> Yes, any other key <span style=color:#66d9ef>for</span> No<span style=color:#f92672>)</span> : y
</span></span><span style=display:flex><span>Success.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>By default, MySQL comes with a database named <span style=color:#e6db74>&#39;test&#39;</span> that
</span></span><span style=display:flex><span>anyone can access. This is also intended only <span style=color:#66d9ef>for</span> testing,
</span></span><span style=display:flex><span>and should be removed before moving into a production
</span></span><span style=display:flex><span>environment.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Remove test database and access to it? <span style=color:#f92672>(</span>Press y|Y <span style=color:#66d9ef>for</span> Yes, any other key <span style=color:#66d9ef>for</span> No<span style=color:#f92672>)</span> : y
</span></span><span style=display:flex><span> - Dropping test database...
</span></span><span style=display:flex><span>Success.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> - Removing privileges on test database...
</span></span><span style=display:flex><span>Success.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Reloading the privilege tables will ensure that all changes
</span></span><span style=display:flex><span>made so far will take effect immediately.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Reload privilege tables now? <span style=color:#f92672>(</span>Press y|Y <span style=color:#66d9ef>for</span> Yes, any other key <span style=color:#66d9ef>for</span> No<span style=color:#f92672>)</span> : y
</span></span><span style=display:flex><span>Success.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>All <span style=color:#66d9ef>done</span>!
</span></span><span style=display:flex><span>root@racknerd-7c9c56:~# sudo mysql
</span></span><span style=display:flex><span>ERROR <span style=color:#ae81ff>1045</span> <span style=color:#f92672>(</span>28000<span style=color:#f92672>)</span>: Access denied <span style=color:#66d9ef>for</span> user <span style=color:#e6db74>&#39;root&#39;</span>@<span style=color:#e6db74>&#39;localhost&#39;</span> <span style=color:#f92672>(</span>using password: NO<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>root@racknerd-7c9c56:~#
</span></span></code></pre></div><p>以上mysql就安装好了，也为wordpress创建了一个库</p><h3 id=安装php>安装php<a hidden class=anchor aria-hidden=true href=#安装php>#</a></h3><p>由于wordpress是php写的，所以需要在机器上安装php，目前最新的wordpress版本是6.4,安装php7.4就好了，不要安装8.0+的版本，</p><p>感觉兼容有问题，折磨了我好久。</p><p>先添加php仓库</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo add-apt-repository ppa:ondrej/php
</span></span></code></pre></div><p>执行到下面最后一行提示的时候按enter继续安装</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>CAVEATS:
</span></span><span style=display:flex><span>1. If you are using php-gearman, you need to add ppa:ondrej/pkg-gearman
</span></span><span style=display:flex><span>2. If you are using apache2, you are advised to add ppa:ondrej/apache2
</span></span><span style=display:flex><span>3. If you are using nginx, you are advised to add ppa:ondrej/nginx-mainline
</span></span><span style=display:flex><span>   or ppa:ondrej/nginx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLEASE READ: If you like my work and want to give me a little motivation, please consider donating regularly: https://donate.sury.org/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WARNING: add-apt-repository is broken with non-UTF-8 locales, see
</span></span><span style=display:flex><span>https://github.com/oerdnj/deb.sury.org/issues/56 for workaround:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php
</span></span><span style=display:flex><span>More info: https://launchpad.net/~ondrej/+archive/ubuntu/php
</span></span><span style=display:flex><span>Adding repository.
</span></span><span style=display:flex><span>Press [ENTER] to continue or Ctrl-c to cancel.
</span></span></code></pre></div><p>上面执行完后，再执行以下命令安装php7.4以及相关插件和服务</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo apt install php7.4 php7.4-fpm php7.4-mysql php7.4-curl php7.4-xml
</span></span></code></pre></div><p>然后使用ps命令查看fpm服务是否启动,可以看到如下fpm服务以及在运行了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:~# ps -ef|grep fpm
</span></span><span style=display:flex><span>root       18996       1  0 14:04 ?        00:00:00 php-fpm: master process (/etc/php/7.4/fpm/php-fpm.conf)
</span></span><span style=display:flex><span>www-data   18997   18996  0 14:04 ?        00:00:00 php-fpm: pool www
</span></span><span style=display:flex><span>www-data   18998   18996  0 14:04 ?        00:00:00 php-fpm: pool www
</span></span><span style=display:flex><span>root       19118    2708  0 14:05 pts/0    00:00:00 grep --color=auto fpm
</span></span></code></pre></div><p>后面nginx需要通过unix socket访问，socket地址具体在<code>/etc/php/7.4/fpm/pool.d/www.conf文件里</code>，这个配置文件有如下几个配置项值得关注一下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>listen = /run/php/php7.4-fpm.sock
</span></span><span style=display:flex><span>listen.owner = www-data
</span></span><span style=display:flex><span>listen.group = www-data
</span></span><span style=display:flex><span>;listen.mode = 0660
</span></span></code></pre></div><p><code>listen = /run/php/php7.4-fpm.sock</code>这个是后续要配置到nginx配置文件中的地址，nginx通过这个地址访问php-fpm服务，然后访问我们的wordpress文件。</p><p>listen支持unix和port 2种配置方式，二选一</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>listen = /run/php/php7.4-fpm.sock
</span></span></code></pre></div><p>或者</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>listen = 127.0.0.1:9000
</span></span></code></pre></div><p>这里配置成哪种格式后面Nginx就配哪种地址，我们这里就采用默认的unix socket的模式就行</p><p><code>lister.owner</code>和<code>list.group</code>以及<code>list.mode</code>这3个配置项涉及fpm进程的权限和用户组问题，nginx需要和这里保持一致，不然可能会报</p><p>奇怪的文件权限问题。</p><p>如上这几个配置项我们保持默认即可，不要去动。</p><h3 id=下载wordpress>下载wordpress<a hidden class=anchor aria-hidden=true href=#下载wordpress>#</a></h3><p>其他的依赖组件都处理好之后，我们下载wordpress安装包，wordpress安装包可以去<a href=wordpress.org>wordpress.org</a>下载</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122219938.png alt=image-20231212221910887></p><p>点击get wordpress，跳转到wordpress下载页</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122220460.png alt=image-20231212222005424></p><p>下载页左边是wordpress的安装包下载地址，当前最新的版本是6.4.2，官方推荐使用php7.4+，mysql5.7+或者mariadb10.4+， mysql</p><p>和mariadb算是同一个作者出品的，2者是兼容的，可以算同一种类型的数据库。</p><p>下载页右边是主机厂商提供的付费解决方案，wordpress已经帮你搭好了，需要按需付费购买。我为了省钱以及可控，就选择了自己搭。</p><h4 id=安装包下载方式>安装包下载方式<a hidden class=anchor aria-hidden=true href=#安装包下载方式>#</a></h4><p>那么wordpress安装包有2种下载方式</p><ul><li>第一种是浏览器页面点击下载，下载到本地之后，通过scp、ftp等方式上传到linux上</li><li>另一种是到机器上使用wget下载安装包</li></ul><p>我这里使用第二种，右键复制链接地址，安装包下载地址为https://wordpress.org/latest.zip</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122223517.png alt=image-20231212222338476></p><p>到机器上执行<code>wget https://wordpress.org/latest.zip</code>将安装包下载到linux机器上，这样下载会方便一点</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:/opt# wget https://wordpress.org/latest.zip
</span></span><span style=display:flex><span>--2023-12-12 14:24:43--  https://wordpress.org/latest.zip
</span></span><span style=display:flex><span>Resolving wordpress.org (wordpress.org)... 198.143.164.252
</span></span><span style=display:flex><span>Connecting to wordpress.org (wordpress.org)|198.143.164.252|:443... connected.
</span></span><span style=display:flex><span>HTTP request sent, awaiting response... 200 OK
</span></span><span style=display:flex><span>Length: 25954973 (25M) [application/zip]
</span></span><span style=display:flex><span>Saving to: ‘latest.zip’
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>latest.zip                               100%[==================================================================================&gt;]  24.75M  30.0MB/s    in 0.8s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>2023-12-12 14:24:44 (30.0 MB/s) - ‘latest.zip’ saved [25954973/25954973]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/opt# ll
</span></span><span style=display:flex><span>total 25356
</span></span><span style=display:flex><span>drwxr-xr-x  2 root root     4096 Dec 12 14:24 ./
</span></span><span style=display:flex><span>drwxr-xr-x 19 root root     4096 Aug 10  2022 ../
</span></span><span style=display:flex><span>-rw-r--r--  1 root root 25954973 Dec  6 16:26 latest.zip
</span></span></code></pre></div><p>我将wordpress放在了opt目录，<em><strong>切忌wordpress不要放在/root目录</strong></em>，不然nginx会有奇怪的文件权限问题，解决不了的那种</p><h4 id=解压安装包>解压安装包<a hidden class=anchor aria-hidden=true href=#解压安装包>#</a></h4><p>解压wordpress安装包，wordpress文件都在/opt/wordpess目录下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt install unzip
</span></span></code></pre></div><p>wordpress文件结构如下所示</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122228332.png alt=image-20231212222818291></p><h4 id=修改wordpress用户组和权限>修改wordpress用户组和权限<a hidden class=anchor aria-hidden=true href=#修改wordpress用户组和权限>#</a></h4><p>这一步的权限比较重要，不然会有奇怪的权限问题，到opt目录下执行如下授权命令，解压之后wordpress目录的用户组都是root，需要</p><p>修改为www-data:www-data，目录权限修改为755，需要用到chown和chmod命令， -R为递归执行所有的子目录和文件</p><p>为何用户组要修改为www-data:www-data，因为php7.4-fpm的pool的用户组就是www-data:www-data</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:/opt# pwd
</span></span><span style=display:flex><span>/opt
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/opt# ll
</span></span><span style=display:flex><span>total 25360
</span></span><span style=display:flex><span>drwxr-xr-x  3 root root     4096 Dec 12 14:27 ./
</span></span><span style=display:flex><span>drwxr-xr-x 19 root root     4096 Aug 10  2022 ../
</span></span><span style=display:flex><span>-rw-r--r--  1 root root 25954973 Dec  6 16:26 latest.zip
</span></span><span style=display:flex><span>drwxr-xr-x  5 root root     4096 Dec  6 16:25 wordpress/
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/opt# sudo chown -R www-data:www-data wordpress/
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/opt# sudo chmod -R 755 wordpress/
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/opt# ll
</span></span><span style=display:flex><span>total 25360
</span></span><span style=display:flex><span>drwxr-xr-x  3 root     root         4096 Dec 12 14:27 ./
</span></span><span style=display:flex><span>drwxr-xr-x 19 root     root         4096 Aug 10  2022 ../
</span></span><span style=display:flex><span>-rw-r--r--  1 root     root     25954973 Dec  6 16:26 latest.zip
</span></span><span style=display:flex><span>drwxr-xr-x  5 www-data www-data     4096 Dec  6 16:25 wordpress/
</span></span></code></pre></div><h4 id=生成wp-configphp>生成wp-config.php<a hidden class=anchor aria-hidden=true href=#生成wp-configphp>#</a></h4><p>从wp-config-sample.php复制一份wp-config.php出来，修改里面的db配置，改为之前本地安装的Mysql的账号密码数据库。</p><p>这一步如果不做的话，在安装页面会引导你填写配置生成一个wp-config.php文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:/opt/wordpress# cp wp-config-sample.php wp-config.php
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/opt/wordpress# vi wp-config.php
</span></span></code></pre></div><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122315725.png alt=image-20231212231519691></p><h3 id=配置nginx>配置nginx<a hidden class=anchor aria-hidden=true href=#配置nginx>#</a></h3><p>下载好wordpress安装包之后，下面就是配置nginx访问wordpress了，这样就可以在浏览器页面访问wordpress安装页面</p><p>nginx配置文件在/etc/nginx/nginx.conf，/etc/nginx/conf.d/用于放自定义配置文件，nginx版本为1.18.0</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122230518.png alt=image-20231212223029466></p><h4 id=自定义wordpress配置文件>自定义wordpress配置文件<a hidden class=anchor aria-hidden=true href=#自定义wordpress配置文件>#</a></h4><p>不修改默认的配置文件，我们在/etc/nginx/conf.d目录下新建wordpress自己的配置文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:/etc/nginx/conf.d# touch wp.conf
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/etc/nginx/conf.d# vi wp.conf
</span></span></code></pre></div><p>将以下配置更新到wp.conf里,有几个比较重要的配置解释一下</p><ul><li>root，这个地方配置的你的wordpress安装包的路径，配置错误会发生404等错误</li><li>server_name，这个如果没域名的话就配置localhost</li><li>fastcgi_pass， 这个地方要配置fpm的服务地址，注意fpm的版本，由于安装的是7.4，所以fastcpgi配置的如下unix地址</li></ul><p>修改好自己机器的实际配置，粘贴到wp.conf，执行:wp 保存配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>root</span> <span style=color:#e6db74>/opt/wordpress</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>index</span> <span style=color:#e6db74>index.php</span> <span style=color:#e6db74>index.html</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>server_name</span> <span style=color:#e6db74>localhost</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>                 <span style=color:#f92672>try_files</span> $uri $uri/ <span style=color:#e6db74>/index.php?</span>$args;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>location</span> ~ <span style=color:#e6db74>\.php$</span> {
</span></span><span style=display:flex><span>                 <span style=color:#f92672>include</span> <span style=color:#e6db74>snippets/fastcgi-php.conf</span>;
</span></span><span style=display:flex><span>                 <span style=color:#f92672>fastcgi_pass</span> <span style=color:#e6db74>unix:/run/php/php7.4-fpm.sock</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#f92672>location</span> ~ <span style=color:#e6db74>/\.ht</span> {
</span></span><span style=display:flex><span>                <span style=color:#f92672>deny</span> <span style=color:#e6db74>all</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>location</span> = <span style=color:#e6db74>/favicon.ico</span> {
</span></span><span style=display:flex><span>                  <span style=color:#f92672>log_not_found</span> <span style=color:#66d9ef>off</span>;
</span></span><span style=display:flex><span>                  <span style=color:#f92672>access_log</span> <span style=color:#66d9ef>off</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>location</span> = <span style=color:#e6db74>/robots.txt</span> {
</span></span><span style=display:flex><span>                  <span style=color:#f92672>allow</span> <span style=color:#e6db74>all</span>;
</span></span><span style=display:flex><span>                  <span style=color:#f92672>log_not_found</span> <span style=color:#66d9ef>off</span>;
</span></span><span style=display:flex><span>                  <span style=color:#f92672>access_log</span> <span style=color:#66d9ef>off</span>;
</span></span><span style=display:flex><span>           }
</span></span><span style=display:flex><span>       
</span></span><span style=display:flex><span>            <span style=color:#f92672>location</span> ~<span style=color:#e6db74>*</span> <span style=color:#e6db74>\.(js|css|png|jpg|jpeg|gif|ico)</span>$ {
</span></span><span style=display:flex><span>                  <span style=color:#f92672>expires</span> <span style=color:#e6db74>max</span>;
</span></span><span style=display:flex><span>                  <span style=color:#f92672>log_not_found</span> <span style=color:#66d9ef>off</span>;
</span></span><span style=display:flex><span>           }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=删除default配置>删除default配置<a hidden class=anchor aria-hidden=true href=#删除default配置>#</a></h4><p>nginx安装好会有一个default配置，这个配置会影响我们自定义的配置，需要删掉或者重命名这个文件，文件路径为<code>/etc/nginx/sites-available/default</code>，执行以下步骤去掉default</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>#在sites-enable目录备份default文件
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/etc/nginx/sites-available# mv default default.bak
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/etc/nginx/sites-available# cd ../sites-enabled/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/etc/nginx/sites-enabled# ll
</span></span><span style=display:flex><span>total 8
</span></span><span style=display:flex><span>drwxr-xr-x 2 root root 4096 Dec 12 13:20 ./
</span></span><span style=display:flex><span>drwxr-xr-x 8 root root 4096 Dec 12 14:31 ../
</span></span><span style=display:flex><span>lrwxrwxrwx 1 root root   34 Dec 12 13:20 default -&gt; /etc/nginx/sites-available/default
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>#在sites-enabled目录删掉软链接
</span></span><span style=display:flex><span>root@racknerd-7c9c56:/etc/nginx/sites-enabled# rm -f default
</span></span></code></pre></div><h4 id=确认nginx-worker的用户>确认nginx worker的用户<a hidden class=anchor aria-hidden=true href=#确认nginx-worker的用户>#</a></h4><p><code>/etc/nginx/nginx.conf</code>的第一行有关于Nginx user的设置，这个需要设置为www-data，和php7.4-fpm保持一致，nginx默认用户就是www-data，检查下即可</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122307418.png alt=image-20231212230724371></p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122307134.png alt=image-20231212230754091></p><h4 id=验证配置>验证配置<a hidden class=anchor aria-hidden=true href=#验证配置>#</a></h4><p>执行如下命令验证nginx配置文件是否正确</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>root@racknerd-7c9c56:/etc/nginx# nginx -t
</span></span><span style=display:flex><span>nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
</span></span><span style=display:flex><span>nginx: configuration file /etc/nginx/nginx.conf test is successful
</span></span></code></pre></div><h4 id=重启nginx>重启Nginx<a hidden class=anchor aria-hidden=true href=#重启nginx>#</a></h4><p>配置文件验证没问题之后，重启Nginx</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo systemctl restart nginx
</span></span></code></pre></div><p>如果启动失败，执行以下2个命令排查错误原因</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>sudo systemctl status nginx.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>journalctl -xe
</span></span></code></pre></div><p>nginx默认日志路径为<code>/var/log/nginx/access.log</code>和<code>/var/log/nginx/error.log</code>,也可以通过nginx日志排查问题</p><h3 id=安装wordpress>安装wordpress<a hidden class=anchor aria-hidden=true href=#安装wordpress>#</a></h3><p>上面步骤一切顺利的话，接下来就到了安装wordpress的环节了，打开浏览器，输入以下地址，其中<code>107.173.87.238</code>是我机器的ip，80是nginx http的端口,替换为自己的ip即可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>http://107.173.87.238/wp-admin/install.php
</span></span></code></pre></div><p>进入安装页面，语言选择简体中文</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122317427.png alt=image-20231212231737375></p><p>输入必要信息之后进行安装，密码可以自定义，也可以用wp生成的强密码</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122318793.png alt=image-20231212231852741></p><p>之后进行登录，就会进入wordpress管理后台，装修自己的网站了</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312122320967.png alt></p><h3 id=配置ssl>配置ssl<a hidden class=anchor aria-hidden=true href=#配置ssl>#</a></h3><p>上述步骤使用nginx+wordprss+mysql安装好了wordpress，已经可以访问了。</p><p>为了网站安全性以及隐藏服务器ip，下面为我们的网站配置ssl以及域名解析。</p><p>配置ss之后，所有的请求都会走https，安全会会得到很大的提高，通过域名访问，也会显得更加的专业，以及保护我们的服务器的ip，减</p><p>少被黑的风险。配域名相比ip也比ip更容易记一点。</p><h4 id=前置依赖-1>前置依赖<a hidden class=anchor aria-hidden=true href=#前置依赖-1>#</a></h4><ul><li>一个属于你的域名，域名需要购买，便宜的比如godaddy上10块，20块左右就能买到一个域名了。其他的google,namecheap之类的也能买到。</li><li>一个dns解析器，将域名解析到服务器ip。一般域名厂商都有这个功能。</li></ul><p>我个人比较喜欢cloudflare，功能强大，国际知名大厂，个人免费，还好使，支持中文，还能生成免费的ssl证书。</p><p>接下来以cloudflare为例，介绍如何配置域名解析，生成ssl证书，以及Nginx如何配置ssl。</p><h4 id=生成ssl证书>生成ssl证书<a hidden class=anchor aria-hidden=true href=#生成ssl证书>#</a></h4><p>没账号的可以先注册一个cloudflare账号，用邮箱注册。</p><p>打开<a href=https://dash.cloudflare.com/>cloudflare控制台</a>，需要先将域名托管到cloudflare，才能配置域名解析。其他厂商自行搜索解决。</p><p>选中要配置解析的域名，打开左侧的SSL/TLS，选中源服务器，右侧点击创建证书。这个证书是用来安装到服务器上的。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142240415.png alt=image-20231214224027324></p><p>进入创建页面，会有一些选项，默认即可。主机名对应nginx server{}块里的server_name，可以自定义，创建证书的时候和服务器上配</p><p>置的server_name保持一致即可。支持通配符。证书有效期最长是15年，够用了。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142243934.png alt=image-20231214224312848></p><p>点击创建之后，会生成一个key和pem文件。key和pem都是要保存下来放到服务器上的。</p><p>私钥只有这一次机会可以复制，关闭这个页面之后就找不到了，所以私钥需要妥善保管，丢失或者遗忘只能重新创建证书了。</p><p>和私钥不同，pem文件之后还可以下载。</p><p>将源证书内容复制，粘贴到xxx.pem文件里。</p><p>将私钥复制，粘贴到xxx.key里。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142246713.png alt=image-20231214224625637></p><p>点击确定之后，会回到证书页面，可以看到，只能下载pem文件，key文件被隐藏，无法下载与访问了</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142251054.png alt=image-20231214225104969></p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142251832.png alt=image-20231214225118743></p><h4 id=nginx配置强制跳转https>nginx配置强制跳转https<a hidden class=anchor aria-hidden=true href=#nginx配置强制跳转https>#</a></h4><p>前面几步，我们监听了80端口，这是Nginx的http接口，现在我们要监听443端口(https)，将80端口的请求强制跳转到443端口。</p><p>首先进入<code>/etc/nginx/config.d/</code>目录，将wp.conf重命名为wp.conf.bak，这样原先的文件就不生效了。</p><p>然后执行<code>touch wp.conf</code>，重新生成空白的wp.conf文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>cd /etc/nginx/config.d
</span></span><span style=display:flex><span>mv wp.conf wp.conf.bak
</span></span><span style=display:flex><span>touch wp.conf
</span></span></code></pre></div><p>然后将下方的配置文件修改后粘贴到wp.conf里</p><p>有如下几次地方需要改成你自己的配置</p><ul><li>2个server块里的server_name，这个地方要配置为上一步创建证书时选择的主机名，我这里要保护的是三级域名，符合通配条件</li><li>记得将ssl_certificate和ssl_certificate_key的位置配置正确</li><li>这个域名的日志重新写到新的文件名了，按需放开或者注释掉</li></ul><p>其他的配置和之前80的配置一致，没有改动</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#75715e># Redirect HTTP -&gt; HTTPS</span>
</span></span><span style=display:flex><span>server {
</span></span><span style=display:flex><span>	listen <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>	server_name www<span style=color:#f92672>.</span>racknerd<span style=color:#f92672>.</span>thend03<span style=color:#f92672>.</span>com racknerd<span style=color:#f92672>.</span>thend03<span style=color:#f92672>.</span>com;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#ae81ff>301</span>   https:<span style=color:#f92672>//$</span>host<span style=color:#f92672>$</span>request_uri;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>server{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	listen <span style=color:#ae81ff>443</span> ssl http2;
</span></span><span style=display:flex><span>	server_name www<span style=color:#f92672>.</span>racknerd<span style=color:#f92672>.</span>thend03<span style=color:#f92672>.</span>com  racknerd<span style=color:#f92672>.</span>thend03<span style=color:#f92672>.</span>com;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	root <span style=color:#f92672>/</span>opt<span style=color:#f92672>/</span>wordpress;
</span></span><span style=display:flex><span>	index index<span style=color:#f92672>.</span>php index<span style=color:#f92672>.</span>html;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e># SSL parameters</span>
</span></span><span style=display:flex><span>	ssl_certificate <span style=color:#f92672>/</span>root<span style=color:#f92672>/</span>thend03<span style=color:#f92672>.</span>com<span style=color:#f92672>.</span>pem;
</span></span><span style=display:flex><span>	ssl_certificate_key <span style=color:#f92672>/</span>root<span style=color:#f92672>/</span>thend03<span style=color:#f92672>.</span>com<span style=color:#f92672>.</span>key;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e># log files</span>
</span></span><span style=display:flex><span>	access_log <span style=color:#f92672>/</span><span style=color:#66d9ef>var</span><span style=color:#f92672>/</span>log<span style=color:#f92672>/</span>nginx<span style=color:#f92672>/</span>resource<span style=color:#f92672>.</span>thend03<span style=color:#f92672>.</span>com<span style=color:#f92672>.</span>access<span style=color:#f92672>.</span>log;
</span></span><span style=display:flex><span>	error_log <span style=color:#f92672>/</span><span style=color:#66d9ef>var</span><span style=color:#f92672>/</span>log<span style=color:#f92672>/</span>nginx<span style=color:#f92672>/</span>resource<span style=color:#f92672>.</span>thend03<span style=color:#f92672>.</span>com<span style=color:#f92672>.</span>error<span style=color:#f92672>.</span>log;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	location <span style=color:#f92672>=</span> <span style=color:#f92672>/</span>favicon<span style=color:#f92672>.</span>ico {
</span></span><span style=display:flex><span>		log_not_found off;
</span></span><span style=display:flex><span>		access_log off;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	location <span style=color:#f92672>=</span> <span style=color:#f92672>/</span>robots<span style=color:#f92672>.</span>txt {
</span></span><span style=display:flex><span>		allow all;
</span></span><span style=display:flex><span>		log_not_found off;
</span></span><span style=display:flex><span>		access_log off;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	location <span style=color:#f92672>/</span> {
</span></span><span style=display:flex><span>		try_files <span style=color:#f92672>$</span>uri <span style=color:#f92672>$</span>uri<span style=color:#f92672>/</span> <span style=color:#f92672>/</span>index<span style=color:#f92672>.</span>php<span style=color:#960050;background-color:#1e0010>?</span><span style=color:#f92672>$</span>args;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	location <span style=color:#f92672>~</span> \<span style=color:#f92672>.</span>php<span style=color:#f92672>$</span> {
</span></span><span style=display:flex><span>		include snippets<span style=color:#f92672>/</span>fastcgi<span style=color:#f92672>-</span>php<span style=color:#f92672>.</span>conf;
</span></span><span style=display:flex><span>		fastcgi_pass unix:<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>php<span style=color:#f92672>/</span>php7<span style=color:#f92672>.</span><span style=color:#ae81ff>4</span><span style=color:#f92672>-</span>fpm<span style=color:#f92672>.</span>sock;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	location <span style=color:#f92672>~*</span> \<span style=color:#f92672>.</span>(js<span style=color:#f92672>|</span>css<span style=color:#f92672>|</span>png<span style=color:#f92672>|</span>jpg<span style=color:#f92672>|</span>jpeg<span style=color:#f92672>|</span>gif<span style=color:#f92672>|</span>ico<span style=color:#f92672>|</span>svg)<span style=color:#f92672>$</span> {
</span></span><span style=display:flex><span>		expires max;
</span></span><span style=display:flex><span>		log_not_found off;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=在服务器生成证书>在服务器生成证书<a hidden class=anchor aria-hidden=true href=#在服务器生成证书>#</a></h4><p>基于上面nginx证书的路径配置，在/root目录生成key和pem证书,并且编辑文件，将在cloudflare页面上生成的key和pem字符串复制到对应的文件里。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>root@racknerd-7c9c56:/etc/nginx/conf.d# cd /root
</span></span><span style=display:flex><span>root@racknerd-7c9c56:~# touch thend03.com.pem
</span></span><span style=display:flex><span>root@racknerd-7c9c56:~# touch thend03.com.key
</span></span><span style=display:flex><span>root@racknerd-7c9c56:~# vi thend03.com.pem
</span></span><span style=display:flex><span>root@racknerd-7c9c56:~# vi thend03.com.key
</span></span></code></pre></div><h4 id=重启nginx-1>重启nginx<a hidden class=anchor aria-hidden=true href=#重启nginx-1>#</a></h4><p>配置好nginx 443配置文件后，执行命令重启nginx</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>root@racknerd-7c9c56:~# sudo systemctl restart nginx
</span></span></code></pre></div><h4 id=cloudflare配置域名解析>cloudflare配置域名解析<a hidden class=anchor aria-hidden=true href=#cloudflare配置域名解析>#</a></h4><p>nginx处理好之后，回到cloudflare页面，配置域名到ip的解析，添加一条A记录，就可以在访问域名的时候请求到后端服务器。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142305079.png alt=image-20231214230521978></p><p>添加好之后，在域名管理那可以看到最新添加的解析记录</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142305173.png alt=image-20231214230543082></p><h4 id=配置ssltls客户端策略>配置ssl/tls客户端策略<a hidden class=anchor aria-hidden=true href=#配置ssltls客户端策略>#</a></h4><p>打开SSL/TLS概述，设置下客户端策略，这里选择端到端，加密等级比较高，并且我们使用的是自签名的证书</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142308546.png alt=image-20231214230802451></p><h4 id=浏览器访问>浏览器访问<a hidden class=anchor aria-hidden=true href=#浏览器访问>#</a></h4><p>解析配置好之后，就是浏览器使用域名访问了。</p><p>访问wp-admin管理后台，这时会跳转到ip，需要我们登录进去之后设置一下</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142313302.png alt=image-20231214231300189></p><p>可以看到域名跳转到了ip</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142313438.png alt=image-20231214231356326></p><p>打开设置，可以看到现在的站点还是ip的方式。需要修改为域名。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142320536.png alt=image-20231214232013465></p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142318072.png alt></p><p>再次登录，地址栏就还是域名，没有变成ip。以后都可以用域名的方式访问了。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/thend03/mdPic/picGo/202312142317238.png alt=image-20231214231714118></p><p>至此，wordpress的手动部署就告一段落了。后续再介绍宝塔面板，docker,docker-compose之类的安装部署。</p><p>以及如何选择模板搭建自己的目标站。</p><h2 id=参考链接>参考链接<a hidden class=anchor aria-hidden=true href=#参考链接>#</a></h2><p><a href=https://zhangwensheng.cn/posts/20190710_pg_with_wordpress_blog_site/>wordpress+postgresql</a></p><p><a href=https://github.com/PostgreSQL-For-Wordpress/postgresql-for-wordpress>pg4wp plugin</a></p><p><a href=https://www.myfreax.com/how-to-install-php-8-1-on-debian-11/>debian安装php8.1</a></p><p><a href=https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-ubuntu-20-04>ubuntu安装mysql</a></p><p><a href=https://www.digitalocean.com/community/tutorials/how-to-install-the-latest-mysql-on-debian-10>debian安装mysql</a></p><p><a href=https://www.digitalocean.com/community/tutorials/install-wordpress-nginx-ubuntu>ubuntu18.04安装wordpress</a></p><p><a href=https://www.hostinger.com/tutorials/how-to-install-wordpress-with-nginx-on-ubuntu/>nginx+wordpress ssl配置</a></p><p><a href=https://developer.wordpress.org/advanced-administration/before-install/howto-install/#step-5-run-the-install-script>wordpress经典五步安装法</a></p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://blog.thend03.com/img/wechat-pay.png alt=wechat_pay></a><p>微信</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://blog.thend03.com/img/alipay.png alt=alipay></a><p>支付宝</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>🧧 鼓励</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://blog.thend03.com/posts/second-half-of-2023/><span class=title>« 上一页</span><br><span>2023年下半年总结</span>
</a><a class=next href=https://blog.thend03.com/posts/goal-setting-and-self-reflection/><span class=title>下一页 »</span><br><span>goal-setting and reflection</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Ubuntu22.04安装wordpress on twitter" href="https://twitter.com/intent/tweet/?text=Ubuntu22.04%e5%ae%89%e8%a3%85wordpress&amp;url=https%3a%2f%2fblog.thend03.com%2fposts%2finstall-wordpress-on-ubuntu22.04%2f&amp;hashtags=wordpress"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Ubuntu22.04安装wordpress on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.thend03.com%2fposts%2finstall-wordpress-on-ubuntu22.04%2f&amp;title=Ubuntu22.04%e5%ae%89%e8%a3%85wordpress&amp;summary=Ubuntu22.04%e5%ae%89%e8%a3%85wordpress&amp;source=https%3a%2f%2fblog.thend03.com%2fposts%2finstall-wordpress-on-ubuntu22.04%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Ubuntu22.04安装wordpress on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.thend03.com%2fposts%2finstall-wordpress-on-ubuntu22.04%2f&title=Ubuntu22.04%e5%ae%89%e8%a3%85wordpress"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Ubuntu22.04安装wordpress on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.thend03.com%2fposts%2finstall-wordpress-on-ubuntu22.04%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Ubuntu22.04安装wordpress on whatsapp" href="https://api.whatsapp.com/send?text=Ubuntu22.04%e5%ae%89%e8%a3%85wordpress%20-%20https%3a%2f%2fblog.thend03.com%2fposts%2finstall-wordpress-on-ubuntu22.04%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share Ubuntu22.04安装wordpress on telegram" href="https://telegram.me/share/url?text=Ubuntu22.04%e5%ae%89%e8%a3%85wordpress&amp;url=https%3a%2f%2fblog.thend03.com%2fposts%2finstall-wordpress-on-ubuntu22.04%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></div><style>.comments_details summary::marker{font-size:20px;content:'👉展开评论';color:var(--content)}.comments_details[open] summary::marker{font-size:20px;content:'👇关闭评论';color:var(--content)}</style><div><details class=comments_details><summary style="cursor:pointer;margin:50px 0 20px;width:130px"><span style=font-size:20px;color:var(--content)>...</span></summary><div id=tcomment></div></details><script src=https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js></script><script>twikoo.init({envId:null,el:"#tcomment",lang:"zh-CN",region:null,path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><span>Copyright
&copy;
2020-2024
<a href=https://blog.thend03.com/ style=color:#939393>Fayy&amp;Fc's Blog</a>
All Rights Reserved
</span><a href=https://beian.miit.gov.cn/ target=_blank style=color:#939393></a>&nbsp;
<span><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null" style=display:inline-block;text-decoration:none;height:20px;color:#939393><img src style="float:left;margin:0 5px 0 0">
</a></span><span id=busuanzi_container><span class="fa fa-user"></span> <span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye"></span> <span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
<span id=read_progress></span>
</span></a><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>200||document.documentElement.scrollTop>200?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{(function(){document.cookie="change-themes="+escape("false")})(),document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.body.addEventListener("copy",function(e){if(window.getSelection().toString()&&window.getSelection().toString().length>50){let t=e.clipboardData||window.clipboardData;if(t){e.preventDefault();let n=window.getSelection().toString(),s=window.getSelection().toString();t.setData("text/html",n),t.setData("text/plain",s)}}})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="复制";function i(){t.innerText="已复制！",setTimeout(()=>{t.innerText="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){let t=e.textContent;navigator.clipboard.writeText(t),i();return}const n=document.createRange();n.selectNodeContents(e);const s=window.getSelection();s.removeAllRanges(),s.addRange(n);try{document.execCommand("copy"),i()}catch{}s.removeRange(n)});let l=e.className.replaceAll("language-",""),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),o=document.createElement("div");o.innerText=l,n.setAttribute("class","mac-tool"),a.setAttribute("class","mac bb1"),r.setAttribute("class","mac bb2"),c.setAttribute("class","mac bb3"),o.setAttribute("class","language-type"),n.appendChild(a),n.appendChild(r),n.appendChild(c),n.appendChild(o),s.classList.contains("highlight")?(s.appendChild(t),s.appendChild(n)):s.parentNode.firstChild==s||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?(e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t),s.appendChild(n)):(e.parentNode.appendChild(t),s.appendChild(n)))})</script></body></html>